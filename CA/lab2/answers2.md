# "Интерполяция сплайнами"

Нужны лекции - [Wiki](https://github.com/Mansurow/IU7-w-2020/wiki#4-%D1%81%D0%B5%D0%BC%D0%B5%D1%81%D1%82%D1%80)

## Данные 
- data.txt - данные из методички
- data1.txt - данные для случае с 3 точками

## Результат

Данные прочитанные из файлы data.txt

Примеры работы:

![image](https://user-images.githubusercontent.com/62243773/160258784-6205bc11-5c90-4685-8902-dc42ab8dd202.png)

![image](https://user-images.githubusercontent.com/62243773/160258790-c0136fdd-2afb-4031-89c5-f70f0131c842.png)

## Вопросы

### 1. Получить выражения для коэффициентов кубического сплайна, построенного на двух точках.

Пусть заданные точки имеют координаты `(x1, y1)`  и `(x2, y2), x1 != x2.`
Тогда для `f(х) = a + b(x - x1) + c(x - x1)^2 + d(x - x1)^3` имеем:
Условия для значения в узлах: `f(x1) = y1, f(x2) = y2`
`a = y1`
`a + b(x - x1) + c(x - x1)^2 + d(x - x1)^3 = y2`
Дополнительные условия для концов могут быть выбраны произвольно. Для простоты, приравняем вторые производные к нулю для получения функции с минимальной кривизной: `f’’(х1) = 0, f’’(x2) = 0`
`2c = 0`
`2c + 6d(x2 - x1) = 0`
Данный набор из 4 уравнений позволяет единственным образом
определить все необходимые коэффициенты.
Очевидно, что `c = 0 и d = 0 =>
=> a + b(x2 - x1) = y2 => a = y1, b = (y2 - y1)/(x2 - x1) =>
=> f(x) = y1 + ((y2 - y1) * (x - x1))/(x2 - x1)`
Получили, что функция выродилась в уравнение прямой, проходящей
через две точки

### 2. Выписать все условия для определения коэффициентов сплайна, построенного на 3-х точках

Сплайн по трём точкам будет состоять из двух функций, поэтому всего неизвестных коэффициентов будет 8.

Условия:
```
1, 2) ai = yi
3, 4) ai + bi(xi+1 - xi) + ci(xi+1 - xi)2 + d(xi+1 - xi)3 = yi+1, f1’(x2) = f2’(x2)
5) b1 + 2c1(x2 - x1) + 3d1(x2 - x1)2 = b2, f1’’(x2) = f2’’(x2)
6) c1 + 3d1(x2 - x1)2 = c2
7) f1’’(x1) = 0 => c1 = 0
8) f2’’(x3) = 0 => c2 + 3d2(x3 - x2) = 0
```

### 3. Определить начальные значения прогоночных коэффициентов, если принять, что для коэффициентов сплайна справедливо C1=C2.

Прогоночные коэффициенты удовлетворяют условиям:
`ci = E_i+1 * c_i+1 + n_i+1`, `E - кси, n - тета`
Поэтому, для `с1 = с2`, начальные значения пригоночных коэффициентов будут равны соответственно:
`E2 = 1, n1 = 0`

---

Условие: количество узлов должно быть достаточным для выбранной степени (например, для полинома степени \(n\) нужно \(n+1\) узел).

---
---

### Ответы на вопросы при защите лабораторной работы

#### 1. Выражения для коэффициентов кубического сплайна на двух точках
Для двух точек \(x_0\) и \(x_1\) кубический сплайн состоит из одного сегмента \(S(x)\) на интервале \([x_0, x_1]\).  
Полином:  
\[
S(x) = a + b(x - x_0) + c(x - x_0)^2 + d(x - x_0)^3.
\]  
Условия:  
1. \(S(x_0) = y_0\).  
2. \(S(x_1) = y_1\).  
3. Естественные граничные условия: \(S''(x_0) = S''(x_1) = 0\).  

Из условий:  
- \(S''(x) = 2c + 6d(x - x_0)\).  
- При \(x = x_0\): \(2c = 0 \Rightarrow c = 0\).  
- При \(x = x_1\): \(2c + 6d(x_1 - x_0) = 0 \Rightarrow 6d(x_1 - x_0) = 0 \Rightarrow d = 0\).  

Остаются коэффициенты \(a = y_0\), \(b = \frac{y_1 - y_0}{x_1 - x_0}\).  
Таким образом, сплайн вырождается в линейную функцию:  
\[
S(x) = y_0 + \frac{y_1 - y_0}{x_1 - x_0}(x - x_0).
\]

---

#### 2. Условия для сплайна на трёх точках
Пусть точки: \(x_0 < x_1 < x_2\).  
Сегменты:  
- \(S_0(x)\) на \([x_0, x_1]\),  
- \(S_1(x)\) на \([x_1, x_2]\).  

Условия:  
1. Совпадение значений:  
   - \(S_0(x_0) = y_0\), \(S_0(x_1) = y_1\),  
   - \(S_1(x_1) = y_1\), \(S_1(x_2) = y_2\).  

2. Непрерывность первых производных:  
   \[
   S_0'(x_1) = S_1'(x_1).
   \]  

3. Непрерывность вторых производных:  
   \[
   S_0''(x_1) = S_1''(x_1).
   \]  

4. Граничные условия (естественные):  
   \[
   S_0''(x_0) = 0, \quad S_1''(x_2) = 0.
   \]  

Всего 8 уравнений для 8 коэффициентов (\(a_0, b_0, c_0, d_0; a_1, b_1, c_1, d_1\)).

---

#### 3. Начальные значения прогоночных коэффициентов при \(C_1 = C_2\)
В методе прогонки коэффициенты выражаются через рекуррентные соотношения.  
Если \(C_1 = C_2\), то из системы уравнений для сплайна:  
\[
\alpha_i C_{i-1} + \beta_i C_i + \gamma_i C_{i+1} = \delta_i,
\]  
подстановка \(C_1 = C_2\) даёт:  
\[
\alpha_1 C_0 + (\beta_1 + \gamma_1) C_1 = \delta_1.
\]  
Начальные значения для прогонки:  
\[
C_0 = 0 \quad (\text{естественное условие}), \quad C_1 = \frac{\delta_1}{\beta_1 + \gamma_1}.
\]

---

#### 4. Выражение для \(C_m\) в обратном ходе прогонки
Дано:  
\[
\alpha C_m + \beta C_{m-1} = \gamma.
\]  
Выразим \(C_m\):  
\[
C_m = \frac{\gamma - \beta C_{m-1}}{\alpha}.
\]  
Это рекуррентное соотношение используется в обратном ходе метода прогонки.

---

#### 5. Шаги интерполяции для \(nx=ny=nz=1\), \(x=y=z=1.5\)
1. Интерполяция по \(y\):  
   - Для каждого слоя \(z_i\) берутся две ближайшие точки по \(y\): \(y=1\) и \(y=2\).  
   - Линейная интерполяция:  
     \[
     u(x, 1.5, z_i) = u(x,1,z_i) + 0.5(u(x,2,z_i) - u(x,1,z_i)).
     \]  

2. Интерполяция по \(x\):  
   - Для каждого \(z_i\) берутся \(x=1\) и \(x=2\).  
   - Линейная интерполяция:  
     \[
     u(1.5, 1.5, z_i) = u(1,1.5,z_i) + 0.5(u(2,1.5,z_i) - u(1,1.5,z_i)).
     \]  

3. Интерполяция по \(z\):  
   - Берутся \(z=1\) и \(z=2\).  
   - Линейная интерполяция:  
     \[
     u(1.5,1.5,1.5) = u(1.5,1.5,1) + 0.5(u(1.5,1.5,2) - u(1.5,1.5,1)).
     \]  

---

#### 6. Алгоритм двумерной интерполяции при хаотичных узлах
- Триангуляция Делоне:  
  1. Разбить область на треугольники так, чтобы все узлы были вершинами.  
  2. Для точки \((x,y)\) найти треугольник, в котором она находится.  
  3. Использовать барицентрические координаты для линейной интерполяции внутри треугольника.  

- Ограничения:  
  - Для линейной интерполяции узлы не должны лежать на одной прямой.  
  - Для полиномов высокой степени требуется регулярное расположение узлов.

---

#### 7. Алгоритм интерполяции по \(n\) переменным
1. Последовательная интерполяция:  
   - Для каждой переменной \(x_1, x_2, ..., x_n\):  
     - Выполнить одномерную интерполяцию по текущей переменной, используя результаты предыдущих шагов.  
   - Пример для 3D: сначала по \(z\), затем по \(y\), затем по \(x\).  

2. Метод:  
   - На каждом шаге используется выбранный метод (полином Ньютона, сплайн).  

---

#### 8. Использование полиномов разных степеней
Да, можно. Например:  
- По \(x\) — полином степени 2,  
- По \(y\) — сплайн,  
- По \(z\) — полином степени 1.

#### 9. Двумерная интерполяция на треугольных узлах
1. Триангуляция Делоне:  
   - Построить сетку треугольников по имеющимся узлам.  
2. Поиск треугольника:  
   - Определить, в какой треугольник попадает точка \((x,y)\).  
3. Барцентрическая интерполяция:  
   - Представить точку в виде:  
     \[
     (x,y) = \lambda_1 (x_1,y_1) + \lambda_2 (x_2,y_2) + \lambda_3 (x_3,y_3),
     \]  
     где \(\lambda_1 + \lambda_2 + \lambda_3 = 1\).  
   - Значение функции:  
     \[
     u(x,y) = \lambda_1 u_1 + \lambda_2 u_2 + \lambda_3 u_3.
     \]  

--- 

Если нужны уточнения по какому-либо пункту, дайте знать!